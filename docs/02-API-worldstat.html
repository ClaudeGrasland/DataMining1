<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 2 L’API Wbstats (Banque Mondiale) | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 2 L’API Wbstats (Banque Mondiale) | DATA MINING" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 L’API Wbstats (Banque Mondiale) | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Claude Grasland, Professeur de Géographie, Université de Paris (Diderot)" />


<meta name="date" content="2021-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="01-API-intro.html"/>
<link rel="next" href="03-API-worldmap.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Data Mining:  <em>C. Grasland (2021)</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="00-presentation.html"><a href="00-presentation.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="00-presentation.html"><a href="00-presentation.html#à-propos-de-ce-document"><i class="fa fa-check"></i>À propos de ce document</a></li>
<li class="chapter" data-level="" data-path="00-presentation.html"><a href="00-presentation.html#prérequis"><i class="fa fa-check"></i>Prérequis</a></li>
<li class="chapter" data-level="" data-path="00-presentation.html"><a href="00-presentation.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="00-presentation.html"><a href="00-presentation.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01-API-intro.html"><a href="01-API-intro.html"><i class="fa fa-check"></i><b>1</b> Collecter des données à l’aide d’une API</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-API-intro.html"><a href="01-API-intro.html#quest-ce-quune-api"><i class="fa fa-check"></i><b>1.1</b> Qu’est-ce qu’une API ?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="01-API-intro.html"><a href="01-API-intro.html#définitions"><i class="fa fa-check"></i><b>1.1.1</b> Définitions</a></li>
<li class="chapter" data-level="1.1.2" data-path="01-API-intro.html"><a href="01-API-intro.html#domaine-dapplication"><i class="fa fa-check"></i><b>1.1.2</b> Domaine d’application</a></li>
<li class="chapter" data-level="1.1.3" data-path="01-API-intro.html"><a href="01-API-intro.html#système-client-serveur"><i class="fa fa-check"></i><b>1.1.3</b> Système client-serveur</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="01-API-intro.html"><a href="01-API-intro.html#comment-utiliser-une-api-dans-r"><i class="fa fa-check"></i><b>1.2</b> Comment utiliser une API dans R ?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="01-API-intro.html"><a href="01-API-intro.html#pourquoi-utiliser-des-api"><i class="fa fa-check"></i><b>1.2.1</b> Pourquoi utiliser des API ?</a></li>
<li class="chapter" data-level="1.2.2" data-path="01-API-intro.html"><a href="01-API-intro.html#installer-les-packages-jsonlite-et-httr"><i class="fa fa-check"></i><b>1.2.2</b> Installer les packages jsonlite et httr</a></li>
<li class="chapter" data-level="1.2.3" data-path="01-API-intro.html"><a href="01-API-intro.html#structure-dune-requête"><i class="fa fa-check"></i><b>1.2.3</b> Structure d’une requête</a></li>
<li class="chapter" data-level="1.2.4" data-path="01-API-intro.html"><a href="01-API-intro.html#extraction-des-données"><i class="fa fa-check"></i><b>1.2.4</b> Extraction des données</a></li>
<li class="chapter" data-level="1.2.5" data-path="01-API-intro.html"><a href="01-API-intro.html#api-et-mise-à-jour-en-temps-réel"><i class="fa fa-check"></i><b>1.2.5</b> API et mise à jour en temps réel</a></li>
<li class="chapter" data-level="1.2.6" data-path="01-API-intro.html"><a href="01-API-intro.html#api-et-requête-paramétrique"><i class="fa fa-check"></i><b>1.2.6</b> API et requête paramétrique</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="01-API-intro.html"><a href="01-API-intro.html#api-ou-data-packages"><i class="fa fa-check"></i><b>1.3</b> API ou data packages ?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="01-API-intro.html"><a href="01-API-intro.html#installation-et-chargement-du-package"><i class="fa fa-check"></i><b>1.3.1</b> Installation et chargement du package</a></li>
<li class="chapter" data-level="1.3.2" data-path="01-API-intro.html"><a href="01-API-intro.html#chargement-de-la-liste-des-tableaux"><i class="fa fa-check"></i><b>1.3.2</b> Chargement de la liste des tableaux</a></li>
<li class="chapter" data-level="1.3.3" data-path="01-API-intro.html"><a href="01-API-intro.html#examen-des-séries-présentes-dans-un-tableau"><i class="fa fa-check"></i><b>1.3.3</b> Examen des séries présentes dans un tableau</a></li>
<li class="chapter" data-level="1.3.4" data-path="01-API-intro.html"><a href="01-API-intro.html#extraction-dune-série-à-laide-de-son-identifiant"><i class="fa fa-check"></i><b>1.3.4</b> Extraction d’une série à l’aide de son identifiant</a></li>
<li class="chapter" data-level="1.3.5" data-path="01-API-intro.html"><a href="01-API-intro.html#extraction-dun-ensemble-de-séries-dun-même-tableau"><i class="fa fa-check"></i><b>1.3.5</b> Extraction d’un ensemble de séries d’un même tableau</a></li>
<li class="chapter" data-level="1.3.6" data-path="01-API-intro.html"><a href="01-API-intro.html#recupération-et-nettoyage-des-données"><i class="fa fa-check"></i><b>1.3.6</b> Recupération et nettoyage des données</a></li>
<li class="chapter" data-level="1.3.7" data-path="01-API-intro.html"><a href="01-API-intro.html#construction-dun-graphique"><i class="fa fa-check"></i><b>1.3.7</b> Construction d’un graphique</a></li>
<li class="chapter" data-level="1.3.8" data-path="01-API-intro.html"><a href="01-API-intro.html#discussion"><i class="fa fa-check"></i><b>1.3.8</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="01-API-intro.html"><a href="01-API-intro.html#exercices"><i class="fa fa-check"></i><b>1.4</b> Exercices</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="01-API-intro.html"><a href="01-API-intro.html#exercice-1-utilisation-de-httr-et-jsonlite"><i class="fa fa-check"></i><b>1.4.1</b> Exercice 1 : utilisation de httr et jsonlite</a></li>
<li class="chapter" data-level="1.4.2" data-path="01-API-intro.html"><a href="01-API-intro.html#exercice-2-utilisation-du-package-insee"><i class="fa fa-check"></i><b>1.4.2</b> Exercice 2 : utilisation du package ‘insee’</a></li>
<li class="chapter" data-level="1.4.3" data-path="01-API-intro.html"><a href="01-API-intro.html#exercice-3-osrm"><i class="fa fa-check"></i><b>1.4.3</b> Exercice 3 : Osrm</a></li>
<li class="chapter" data-level="1.4.4" data-path="01-API-intro.html"><a href="01-API-intro.html#exercice-4-exploration-de-nouvelles-api"><i class="fa fa-check"></i><b>1.4.4</b> Exercice 4 : Exploration de nouvelles API</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html"><i class="fa fa-check"></i><b>2</b> L’API Wbstats (Banque Mondiale)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#objectifs"><i class="fa fa-check"></i><b>2.1</b> Objectifs</a></li>
<li class="chapter" data-level="2.2" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-tableau-countries"><i class="fa fa-check"></i><b>2.2</b> Le tableau “countries”</a></li>
<li class="chapter" data-level="2.3" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-tableau-indicators"><i class="fa fa-check"></i><b>2.3</b> Le tableau indicators</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#recherche-du-code-dun-indicateur"><i class="fa fa-check"></i><b>2.3.1</b> Recherche du code d’un indicateur</a></li>
<li class="chapter" data-level="2.3.2" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#extraction-des-métadonnées"><i class="fa fa-check"></i><b>2.3.2</b> Extraction des métadonnées</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#lextraction-des-données"><i class="fa fa-check"></i><b>2.4</b> L’extraction des données</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-paramètre-indicator"><i class="fa fa-check"></i><b>2.4.1</b> le paramètre <code>indicator =</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-choix-dune-période-de-temps"><i class="fa fa-check"></i><b>2.4.2</b> le choix d’une période de temps</a></li>
<li class="chapter" data-level="2.4.3" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-choix-des-unités-géographiques"><i class="fa fa-check"></i><b>2.4.3</b> Le choix des unités géographiques</a></li>
<li class="chapter" data-level="2.4.4" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#le-format-de-sortie-du-tableau"><i class="fa fa-check"></i><b>2.4.4</b> Le format de sortie du tableau</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#exercices-1"><i class="fa fa-check"></i><b>2.5</b> Exercices</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#exercice-1"><i class="fa fa-check"></i><b>2.5.1</b> Exercice 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#exercice-2"><i class="fa fa-check"></i><b>2.5.2</b> Exercice 2</a></li>
<li class="chapter" data-level="2.5.3" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#exercice-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercice 3</a></li>
<li class="chapter" data-level="2.5.4" data-path="02-API-worldstat.html"><a href="02-API-worldstat.html#exercice-4"><i class="fa fa-check"></i><b>2.5.4</b> Exercice 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html"><i class="fa fa-check"></i><b>3</b> L’API Natural Earth</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#objectifs-1"><i class="fa fa-check"></i><b>3.1</b> Objectifs</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#quel-fonds-de-carte-choisir"><i class="fa fa-check"></i><b>3.1.1</b> Quel fonds de carte choisir ?</a></li>
<li class="chapter" data-level="3.1.2" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#le-fonds-de-carte-countries110-175-unités"><i class="fa fa-check"></i><b>3.1.2</b> le fonds de carte <em>countries110</em> (175 unités)</a></li>
<li class="chapter" data-level="3.1.3" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#le-fonds-de-carte-sovereignty110-171-unités"><i class="fa fa-check"></i><b>3.1.3</b> le fonds de carte <em>sovereignty110</em> (171 unités)</a></li>
<li class="chapter" data-level="3.1.4" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#le-fonds-de-carte-countries50"><i class="fa fa-check"></i><b>3.1.4</b> Le fonds de carte <em>countries50</em></a></li>
<li class="chapter" data-level="3.1.5" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#autres-fonds-de-carte"><i class="fa fa-check"></i><b>3.1.5</b> Autres fonds de carte :</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#exemple-de-combinaison-des-api-wbstats-et-naturalearth"><i class="fa fa-check"></i><b>3.2</b> Exemple de combinaison des API wbstats et naturalearth</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#etape-1-récupération-des-données-statistiques"><i class="fa fa-check"></i><b>3.2.1</b> Etape 1 : récupération des données statistiques</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#etape-2-récupération-du-fonds-de-carte"><i class="fa fa-check"></i><b>3.2.2</b> Etape 2 : Récupération du fonds de carte</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#etape-3-jointure-du-fonds-de-carte-et-des-statistiques"><i class="fa fa-check"></i><b>3.2.3</b> Etape 3 : Jointure du fonds de carte et des statistiques</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#etape-4-visualisation-avec-ggplot"><i class="fa fa-check"></i><b>3.2.4</b> Etape 4 : Visualisation avec ggplot</a></li>
<li class="chapter" data-level="3.2.5" data-path="03-API-worldmap.html"><a href="03-API-worldmap.html#etape-5-visualisation-avec-plotly"><i class="fa fa-check"></i><b>3.2.5</b> Etape 5 :Visualisation avec plotly</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c02-API-worldstat" class="section level1" number="2">
<h1><span class="header-section-number">Chapitre 2</span> L’API Wbstats (Banque Mondiale)</h1>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="02-API-worldstat.html#cb36-1"></a><span class="co">## Global options</span></span>
<span id="cb36-2"><a href="02-API-worldstat.html#cb36-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb36-3"><a href="02-API-worldstat.html#cb36-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb36-4"><a href="02-API-worldstat.html#cb36-4"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb36-5"><a href="02-API-worldstat.html#cb36-5"></a>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>,</span>
<span id="cb36-6"><a href="02-API-worldstat.html#cb36-6"></a>               <span class="dt">cache=</span><span class="ot">TRUE</span>,</span>
<span id="cb36-7"><a href="02-API-worldstat.html#cb36-7"></a>               <span class="dt">prompt=</span><span class="ot">FALSE</span>,</span>
<span id="cb36-8"><a href="02-API-worldstat.html#cb36-8"></a>               <span class="dt">tidy=</span><span class="ot">FALSE</span>,</span>
<span id="cb36-9"><a href="02-API-worldstat.html#cb36-9"></a>               <span class="dt">comment=</span><span class="ot">NA</span>,</span>
<span id="cb36-10"><a href="02-API-worldstat.html#cb36-10"></a>               <span class="dt">message=</span><span class="ot">FALSE</span>,</span>
<span id="cb36-11"><a href="02-API-worldstat.html#cb36-11"></a>               <span class="dt">warning=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<div id="objectifs" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Objectifs</h2>
<p>Supposons que l’on souhaite télécharger la population, le PIB et les émisssions de CO2 des pays du monde de 2000 à 2015. Plutôt que d’aller chercher des fichiers sur un site web, nous allons utiliser une API proposée par la Banque Mondiale qui permet de télécharger les données facilement et surtout de les mettre à jour régulièrement. Pour cela on va installer le package R correspondant à l’API <code>wbstats</code> de la Banque mondiale.</p>
<p><a href="https://cran.r-project.org/web/packages/wbstats/vignettes/Using_the_wbstats_package.html" class="uri">https://cran.r-project.org/web/packages/wbstats/vignettes/Using_the_wbstats_package.html</a></p>
<p>Au moment du chargement du package, il est créé un fichier wb_cachelist qui fournit l’ensemble des donnes disponibles sous la forme d’une liste de tableaux de méta-données.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="02-API-worldstat.html#cb37-1"></a><span class="kw">library</span>(<span class="st">&quot;wbstats&quot;</span>)</span>
<span id="cb37-2"><a href="02-API-worldstat.html#cb37-2"></a>cat&lt;-wb_cachelist</span>
<span id="cb37-3"><a href="02-API-worldstat.html#cb37-3"></a><span class="kw">str</span>(cat,<span class="dt">max.level =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>List of 8
 $ countries    : tibble [304 × 18] (S3: tbl_df/tbl/data.frame)
 $ indicators   : tibble [16,649 × 8] (S3: tbl_df/tbl/data.frame)
 $ sources      : tibble [63 × 9] (S3: tbl_df/tbl/data.frame)
 $ topics       : tibble [21 × 3] (S3: tbl_df/tbl/data.frame)
 $ regions      : tibble [48 × 4] (S3: tbl_df/tbl/data.frame)
 $ income_levels: tibble [7 × 3] (S3: tbl_df/tbl/data.frame)
 $ lending_types: tibble [4 × 3] (S3: tbl_df/tbl/data.frame)
 $ languages    : tibble [23 × 3] (S3: tbl_df/tbl/data.frame)</code></pre>
</div>
<div id="le-tableau-countries" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Le tableau “countries”</h2>
<p>Il fournit des renseignements de base sur les différents pays, leurs codes, etc.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="02-API-worldstat.html#cb39-1"></a><span class="kw">str</span>(cat<span class="op">$</span>countries)</span></code></pre></div>
<pre><code>tibble [304 × 18] (S3: tbl_df/tbl/data.frame)
 $ iso3c             : chr [1:304] &quot;ABW&quot; &quot;AFG&quot; &quot;AFR&quot; &quot;AGO&quot; ...
 $ iso2c             : chr [1:304] &quot;AW&quot; &quot;AF&quot; &quot;A9&quot; &quot;AO&quot; ...
 $ country           : chr [1:304] &quot;Aruba&quot; &quot;Afghanistan&quot; &quot;Africa&quot; &quot;Angola&quot; ...
 $ capital_city      : chr [1:304] &quot;Oranjestad&quot; &quot;Kabul&quot; NA &quot;Luanda&quot; ...
 $ longitude         : num [1:304] -70 69.2 NA 13.2 19.8 ...
 $ latitude          : num [1:304] 12.52 34.52 NA -8.81 41.33 ...
 $ region_iso3c      : chr [1:304] &quot;LCN&quot; &quot;SAS&quot; NA &quot;SSF&quot; ...
 $ region_iso2c      : chr [1:304] &quot;ZJ&quot; &quot;8S&quot; NA &quot;ZG&quot; ...
 $ region            : chr [1:304] &quot;Latin America &amp; Caribbean&quot; &quot;South Asia&quot; &quot;Aggregates&quot; &quot;Sub-Saharan Africa&quot; ...
 $ admin_region_iso3c: chr [1:304] NA &quot;SAS&quot; NA &quot;SSA&quot; ...
 $ admin_region_iso2c: chr [1:304] NA &quot;8S&quot; NA &quot;ZF&quot; ...
 $ admin_region      : chr [1:304] NA &quot;South Asia&quot; NA &quot;Sub-Saharan Africa (excluding high income)&quot; ...
 $ income_level_iso3c: chr [1:304] &quot;HIC&quot; &quot;LIC&quot; NA &quot;LMC&quot; ...
 $ income_level_iso2c: chr [1:304] &quot;XD&quot; &quot;XM&quot; NA &quot;XN&quot; ...
 $ income_level      : chr [1:304] &quot;High income&quot; &quot;Low income&quot; &quot;Aggregates&quot; &quot;Lower middle income&quot; ...
 $ lending_type_iso3c: chr [1:304] &quot;LNX&quot; &quot;IDX&quot; NA &quot;IBD&quot; ...
 $ lending_type_iso2c: chr [1:304] &quot;XX&quot; &quot;XI&quot; NA &quot;XF&quot; ...
 $ lending_type      : chr [1:304] &quot;Not classified&quot; &quot;IDA&quot; &quot;Aggregates&quot; &quot;IBRD&quot; ...</code></pre>
<p>Le tableau comporte 304 observation et il mélange des pays (France), des fragments de pays (Réunion) et des agrégats de pays (Europe). Il faudra donc bien faire attention lors de l’extraction à réfléchir à ce que l’on souhaite utiliser. Par exemple, si l’on veut juste les pays :</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="02-API-worldstat.html#cb41-1"></a><span class="co">## Programme en langage R_base</span></span>
<span id="cb41-2"><a href="02-API-worldstat.html#cb41-2"></a><span class="co"># pays&lt;-cat$countries[cat$countries$income_level!=&quot;Aggregates&quot;,c(&quot;iso3c&quot;, &quot;country&quot;,&quot;capital_city&quot;,&quot;longitude&quot;,&quot;latitude&quot;, &quot;region&quot;,&quot;income_level&quot;)]</span></span>
<span id="cb41-3"><a href="02-API-worldstat.html#cb41-3"></a></span>
<span id="cb41-4"><a href="02-API-worldstat.html#cb41-4"></a></span>
<span id="cb41-5"><a href="02-API-worldstat.html#cb41-5"></a><span class="co">## Programme en langage dplyr</span></span>
<span id="cb41-6"><a href="02-API-worldstat.html#cb41-6"></a></span>
<span id="cb41-7"><a href="02-API-worldstat.html#cb41-7"></a>pays &lt;-<span class="st"> </span>cat<span class="op">$</span>countries <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-8"><a href="02-API-worldstat.html#cb41-8"></a><span class="st">          </span><span class="kw">filter</span>(income_level <span class="op">!=</span><span class="st">&quot;Aggregates&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb41-9"><a href="02-API-worldstat.html#cb41-9"></a><span class="st">          </span><span class="kw">select</span>(iso3c,country, capital_city, latitude, longitude, region, income_level)</span>
<span id="cb41-10"><a href="02-API-worldstat.html#cb41-10"></a></span>
<span id="cb41-11"><a href="02-API-worldstat.html#cb41-11"></a></span>
<span id="cb41-12"><a href="02-API-worldstat.html#cb41-12"></a><span class="kw">kable</span>(<span class="kw">head</span>(pays))</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="19%" />
<col width="15%" />
<col width="8%" />
<col width="9%" />
<col width="24%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="left">capital_city</th>
<th align="right">latitude</th>
<th align="right">longitude</th>
<th align="left">region</th>
<th align="left">income_level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="left">Oranjestad</td>
<td align="right">12.51670</td>
<td align="right">-70.0167</td>
<td align="left">Latin America &amp; Caribbean</td>
<td align="left">High income</td>
</tr>
<tr class="even">
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="left">Kabul</td>
<td align="right">34.52280</td>
<td align="right">69.1761</td>
<td align="left">South Asia</td>
<td align="left">Low income</td>
</tr>
<tr class="odd">
<td align="left">AGO</td>
<td align="left">Angola</td>
<td align="left">Luanda</td>
<td align="right">-8.81155</td>
<td align="right">13.2420</td>
<td align="left">Sub-Saharan Africa</td>
<td align="left">Lower middle income</td>
</tr>
<tr class="even">
<td align="left">ALB</td>
<td align="left">Albania</td>
<td align="left">Tirane</td>
<td align="right">41.33170</td>
<td align="right">19.8172</td>
<td align="left">Europe &amp; Central Asia</td>
<td align="left">Upper middle income</td>
</tr>
<tr class="odd">
<td align="left">AND</td>
<td align="left">Andorra</td>
<td align="left">Andorra la Vella</td>
<td align="right">42.50750</td>
<td align="right">1.5218</td>
<td align="left">Europe &amp; Central Asia</td>
<td align="left">High income</td>
</tr>
<tr class="even">
<td align="left">ARE</td>
<td align="left">United Arab Emirates</td>
<td align="left">Abu Dhabi</td>
<td align="right">24.47640</td>
<td align="right">54.3705</td>
<td align="left">Middle East &amp; North Africa</td>
<td align="left">High income</td>
</tr>
</tbody>
</table>
</div>
<div id="le-tableau-indicators" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Le tableau indicators</h2>
<p>Il comporte pas loin de 17000 variables … Autant dire qu’il est difficile de l’explorer facilement si l’on ne sait pas ce que l’on cherche.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="02-API-worldstat.html#cb42-1"></a>indic&lt;-cat<span class="op">$</span>indicators</span>
<span id="cb42-2"><a href="02-API-worldstat.html#cb42-2"></a><span class="kw">dim</span>(indic)</span></code></pre></div>
<pre><code>[1] 16649     8</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="02-API-worldstat.html#cb44-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(indic))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="11%" />
<col width="1%" />
<col width="46%" />
<col width="20%" />
<col width="5%" />
<col width="2%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">indicator_id</th>
<th align="left">indicator</th>
<th align="left">unit</th>
<th align="left">indicator_desc</th>
<th align="left">source_org</th>
<th align="left">topics</th>
<th align="right">source_id</th>
<th align="left">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.0.HCount.1.90usd</td>
<td align="left">Poverty Headcount ($1.90 a day)</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income (in 2011 PPP) below the poverty line.</td>
<td align="left">LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank).</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
<tr class="even">
<td align="left">1.0.HCount.2.5usd</td>
<td align="left">Poverty Headcount ($2.50 a day)</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP) below the poverty line.</td>
<td align="left">LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank).</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
<tr class="odd">
<td align="left">1.0.HCount.Mid10to50</td>
<td align="left">Middle Class ($10-50 a day) Headcount</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP) below the poverty line.</td>
<td align="left">LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank).</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
<tr class="even">
<td align="left">1.0.HCount.Ofcl</td>
<td align="left">Official Moderate Poverty Rate-National</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income below the official poverty line developed by each country.</td>
<td align="left">LAC Equity Lab tabulations of data from National Statistical Offices.</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
<tr class="odd">
<td align="left">1.0.HCount.Poor4uds</td>
<td align="left">Poverty Headcount ($4 a day)</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP) below the poverty line.</td>
<td align="left">LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank).</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
<tr class="even">
<td align="left">1.0.HCount.Vul4to10</td>
<td align="left">Vulnerable ($4-10 a day) Headcount</td>
<td align="left">NA</td>
<td align="left">The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP) below the poverty line.</td>
<td align="left">LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank).</td>
<td align="left">11 , Poverty</td>
<td align="right">37</td>
<td align="left">LAC Equity Lab</td>
</tr>
</tbody>
</table>
<div id="recherche-du-code-dun-indicateur" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Recherche du code d’un indicateur</h3>
<p>Supposons qu’on recherche les données récentes sur les émissions de CO2. On va utiliser le mot-clé <em>CO2</em> pour rechercher les variables correspondantes dans le catalogue à l’aide de la fonction <code>wbsearch</code>, ce qui donne 45 réponses</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="02-API-worldstat.html#cb45-1"></a>vars &lt;-<span class="st"> </span><span class="kw">wbsearch</span>(<span class="dt">pattern =</span> <span class="st">&quot;CO2&quot;</span>,<span class="dt">fields=</span><span class="st">&quot;indicator&quot;</span>)</span></code></pre></div>
<pre><code>Warning: `wbsearch()` is deprecated as of wbstats 1.0.0.
Please use `wb_search()` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="02-API-worldstat.html#cb47-1"></a><span class="kw">kable</span>(vars)</span></code></pre></div>
<table>
<colgroup>
<col width="3%" />
<col width="13%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">indicatorID</th>
<th align="left">indicator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5294</td>
<td align="left">EN.ATM.CO2E.CP.KT</td>
<td align="left">CO2 emissions from cement production (thousand metric tons)</td>
</tr>
<tr class="even">
<td align="left">5295</td>
<td align="left">EN.ATM.CO2E.EG.ZS</td>
<td align="left">CO2 intensity (kg per kg of oil equivalent energy use)</td>
</tr>
<tr class="odd">
<td align="left">5296</td>
<td align="left">EN.ATM.CO2E.FF.KT</td>
<td align="left">CO2 emissions from fossil-fuels, total (thousand metric tons)</td>
</tr>
<tr class="even">
<td align="left">5297</td>
<td align="left">EN.ATM.CO2E.FF.ZS</td>
<td align="left">CO2 emissions from fossil-fuels (% of total)</td>
</tr>
<tr class="odd">
<td align="left">5298</td>
<td align="left">EN.ATM.CO2E.GDP</td>
<td align="left">CO2 emissions, industrial (kg per 1987 US$ of GDP)</td>
</tr>
<tr class="even">
<td align="left">5299</td>
<td align="left">EN.ATM.CO2E.GF.KT</td>
<td align="left">CO2 emissions from gaseous fuel consumption (kt)</td>
</tr>
<tr class="odd">
<td align="left">5300</td>
<td align="left">EN.ATM.CO2E.GF.ZS</td>
<td align="left">CO2 emissions from gaseous fuel consumption (% of total)</td>
</tr>
<tr class="even">
<td align="left">5301</td>
<td align="left">EN.ATM.CO2E.GL.KT</td>
<td align="left">CO2 emissions from gas flaring (thousand metric tons)</td>
</tr>
<tr class="odd">
<td align="left">5302</td>
<td align="left">EN.ATM.CO2E.KD.87.GD</td>
<td align="left">CO2 emissions, industrial (kg per 1987 US$ of GDP)</td>
</tr>
<tr class="even">
<td align="left">5303</td>
<td align="left">EN.ATM.CO2E.KD.GD</td>
<td align="left">CO2 emissions (kg per 2010 US$ of GDP)</td>
</tr>
<tr class="odd">
<td align="left">5304</td>
<td align="left">EN.ATM.CO2E.KT</td>
<td align="left">CO2 emissions (kt)</td>
</tr>
<tr class="even">
<td align="left">5305</td>
<td align="left">EN.ATM.CO2E.LF.KT</td>
<td align="left">CO2 emissions from liquid fuel consumption (kt)</td>
</tr>
<tr class="odd">
<td align="left">5306</td>
<td align="left">EN.ATM.CO2E.LF.ZS</td>
<td align="left">CO2 emissions from liquid fuel consumption (% of total)</td>
</tr>
<tr class="even">
<td align="left">5307</td>
<td align="left">EN.ATM.CO2E.PC</td>
<td align="left">CO2 emissions (metric tons per capita)</td>
</tr>
<tr class="odd">
<td align="left">5308</td>
<td align="left">EN.ATM.CO2E.PP.GD</td>
<td align="left">CO2 emissions (kg per PPP $ of GDP)</td>
</tr>
<tr class="even">
<td align="left">5309</td>
<td align="left">EN.ATM.CO2E.PP.GD.KD</td>
<td align="left">CO2 emissions (kg per 2017 PPP $ of GDP)</td>
</tr>
<tr class="odd">
<td align="left">5310</td>
<td align="left">EN.ATM.CO2E.SF.KT</td>
<td align="left">CO2 emissions from solid fuel consumption (kt)</td>
</tr>
<tr class="even">
<td align="left">5311</td>
<td align="left">EN.ATM.CO2E.SF.ZS</td>
<td align="left">CO2 emissions from solid fuel consumption (% of total)</td>
</tr>
<tr class="odd">
<td align="left">5312</td>
<td align="left">EN.ATM.GHGO.KT.CE</td>
<td align="left">Other greenhouse gas emissions, HFC, PFC and SF6 (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5314</td>
<td align="left">EN.ATM.GHGT.KT.CE</td>
<td align="left">Total greenhouse gas emissions (kt of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5316</td>
<td align="left">EN.ATM.HFCG.KT.CE</td>
<td align="left">HFC gas emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5317</td>
<td align="left">EN.ATM.METH.AG.KT.CE</td>
<td align="left">Agricultural methane emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5319</td>
<td align="left">EN.ATM.METH.EG.KT.CE</td>
<td align="left">Methane emissions in energy sector (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5322</td>
<td align="left">EN.ATM.METH.KT.CE</td>
<td align="left">Methane emissions (kt of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5323</td>
<td align="left">EN.ATM.METH.PC</td>
<td align="left">Methane emissions (kt of CO2 equivalent per capita)</td>
</tr>
<tr class="even">
<td align="left">5325</td>
<td align="left">EN.ATM.NOXE.AG.KT.CE</td>
<td align="left">Agricultural nitrous oxide emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5327</td>
<td align="left">EN.ATM.NOXE.EG.KT.CE</td>
<td align="left">Nitrous oxide emissions in energy sector (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5330</td>
<td align="left">EN.ATM.NOXE.IN.KT.CE</td>
<td align="left">Industrial nitrous oxide emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5332</td>
<td align="left">EN.ATM.NOXE.KT.CE</td>
<td align="left">Nitrous oxide emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5333</td>
<td align="left">EN.ATM.NOXE.MT.CE</td>
<td align="left">Nitrous oxide emissions (metric tons of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5334</td>
<td align="left">EN.ATM.NOXE.PC</td>
<td align="left">Nitrous oxide emissions (metric tons of CO2 equivalent per capita)</td>
</tr>
<tr class="even">
<td align="left">5336</td>
<td align="left">EN.ATM.PFCG.KT.CE</td>
<td align="left">PFC gas emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5343</td>
<td align="left">EN.ATM.SF6G.KT.CE</td>
<td align="left">SF6 gas emissions (thousand metric tons of CO2 equivalent)</td>
</tr>
<tr class="even">
<td align="left">5348</td>
<td align="left">EN.CLC.GHGR.MT.CE</td>
<td align="left">GHG net emissions/removals by LUCF (Mt of CO2 equivalent)</td>
</tr>
<tr class="odd">
<td align="left">5353</td>
<td align="left">EN.CO2.BLDG.MT</td>
<td align="left">CO2 emissions from residential buildings and commercial and public services (million metric tons)</td>
</tr>
<tr class="even">
<td align="left">5354</td>
<td align="left">EN.CO2.BLDG.ZS</td>
<td align="left">CO2 emissions from residential buildings and commercial and public services (% of total fuel combustion)</td>
</tr>
<tr class="odd">
<td align="left">5355</td>
<td align="left">EN.CO2.ETOT.MT</td>
<td align="left">CO2 emissions from electricity and heat production, total (million metric tons)</td>
</tr>
<tr class="even">
<td align="left">5356</td>
<td align="left">EN.CO2.ETOT.ZS</td>
<td align="left">CO2 emissions from electricity and heat production, total (% of total fuel combustion)</td>
</tr>
<tr class="odd">
<td align="left">5357</td>
<td align="left">EN.CO2.MANF.MT</td>
<td align="left">CO2 emissions from manufacturing industries and construction (million metric tons)</td>
</tr>
<tr class="even">
<td align="left">5358</td>
<td align="left">EN.CO2.MANF.ZS</td>
<td align="left">CO2 emissions from manufacturing industries and construction (% of total fuel combustion)</td>
</tr>
<tr class="odd">
<td align="left">5359</td>
<td align="left">EN.CO2.OTHX.MT</td>
<td align="left">CO2 emissions from other sectors, excluding residential buildings and commercial and public services (million metric tons)</td>
</tr>
<tr class="even">
<td align="left">5360</td>
<td align="left">EN.CO2.OTHX.ZS</td>
<td align="left">CO2 emissions from other sectors, excluding residential buildings and commercial and public services (% of total fuel combustion)</td>
</tr>
<tr class="odd">
<td align="left">5361</td>
<td align="left">EN.CO2.TRAN.MT</td>
<td align="left">CO2 emissions from transport (million metric tons)</td>
</tr>
<tr class="even">
<td align="left">5362</td>
<td align="left">EN.CO2.TRAN.ZS</td>
<td align="left">CO2 emissions from transport (% of total fuel combustion)</td>
</tr>
<tr class="odd">
<td align="left">8231</td>
<td align="left">IN.ENV.CO2.CONC</td>
<td align="left">CO2 Emission (in thousand metric tons of Carbon)</td>
</tr>
</tbody>
</table>
<p>On va finalement trouver le code de la variable recherchée</p>
<ul>
<li><em>EN.ATM.CO2E.KT</em> : émissions de CO2 en kilotonnes</li>
</ul>
<p>Les deux autres variables dont nous avons besoin ont pour code</p>
<ul>
<li><em>NY.GDP.MKTP.CD</em> : PIB en parités de pouvoir d’achat</li>
<li><em>SP.POP.TOTL</em> : Population totale</li>
</ul>
</div>
<div id="extraction-des-métadonnées" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Extraction des métadonnées</h3>
<p>Une fois que l’on pense connaître le code de nos variables, on peut extraire les métadonnés pour vérifier qu’il s’agit bien de ce que l’on cherche, quelle est la source exacte, quelle est l’unité de mesure …</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="02-API-worldstat.html#cb48-1"></a><span class="co"># Programme R-base</span></span>
<span id="cb48-2"><a href="02-API-worldstat.html#cb48-2"></a>meta&lt;-cat<span class="op">$</span>indicators[cat<span class="op">$</span>indicators<span class="op">$</span>indicator_id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SP.POP.TOTL&quot;</span>,<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>),]</span>
<span id="cb48-3"><a href="02-API-worldstat.html#cb48-3"></a></span>
<span id="cb48-4"><a href="02-API-worldstat.html#cb48-4"></a><span class="co"># Programme dplyr</span></span>
<span id="cb48-5"><a href="02-API-worldstat.html#cb48-5"></a>meta&lt;-cat<span class="op">$</span>indicators <span class="op">%&gt;%</span></span>
<span id="cb48-6"><a href="02-API-worldstat.html#cb48-6"></a><span class="st">        </span><span class="kw">filter</span>(indicator_id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SP.POP.TOTL&quot;</span>,<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>))</span>
<span id="cb48-7"><a href="02-API-worldstat.html#cb48-7"></a></span>
<span id="cb48-8"><a href="02-API-worldstat.html#cb48-8"></a><span class="kw">kable</span>(meta)</span></code></pre></div>
<table>
<colgroup>
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="52%" />
<col width="35%" />
<col width="4%" />
<col width="0%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">indicator_id</th>
<th align="left">indicator</th>
<th align="left">unit</th>
<th align="left">indicator_desc</th>
<th align="left">source_org</th>
<th align="left">topics</th>
<th align="right">source_id</th>
<th align="left">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EN.ATM.CO2E.KT</td>
<td align="left">CO2 emissions (kt)</td>
<td align="left">NA</td>
<td align="left">Carbon dioxide emissions are those stemming from the burning of fossil fuels and the manufacture of cement. They include carbon dioxide produced during consumption of solid, liquid, and gas fuels and gas flaring.</td>
<td align="left">Carbon Dioxide Information Analysis Center, Environmental Sciences Division, Oak Ridge National Laboratory, Tennessee, United States.</td>
<td align="left">19 , 6 , Climate Change, Environment</td>
<td align="right">2</td>
<td align="left">World Development Indicators</td>
</tr>
<tr class="even">
<td align="left">NY.GDP.MKTP.CD</td>
<td align="left">GDP (current US$)</td>
<td align="left">NA</td>
<td align="left">GDP at purchaser’s prices is the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in current U.S. dollars. Dollar figures for GDP are converted from domestic currencies using single year official exchange rates. For a few countries where the official exchange rate does not reflect the rate effectively applied to actual foreign exchange transactions, an alternative conversion factor is used.</td>
<td align="left">World Bank national accounts data, and OECD National Accounts data files.</td>
<td align="left">3 , Economy &amp; Growth</td>
<td align="right">2</td>
<td align="left">World Development Indicators</td>
</tr>
<tr class="odd">
<td align="left">SP.POP.TOTL</td>
<td align="left">Population, total</td>
<td align="left">NA</td>
<td align="left">Total population is based on the de facto definition of population, which counts all residents regardless of legal status or citizenship. The values shown are midyear estimates.</td>
<td align="left">(1) United Nations Population Division. World Population Prospects: 2019 Revision. (2) Census reports and other statistical publications from national statistical offices, (3) Eurostat: Demographic Statistics, (4) United Nations Statistical Division. Population and Vital Statistics Reprot (various years), (5) U.S. Census Bureau: International Database, and (6) Secretariat of the Pacific Community: Statistics and Demography Programme.</td>
<td align="left">19 , 8 , Climate Change, Health</td>
<td align="right">2</td>
<td align="left">World Development Indicators</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="lextraction-des-données" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> L’extraction des données</h2>
<p>Elle se fait à l’aide de la fonction <code>wb_data</code> qui comporte de nombreuses options.</p>
<div id="le-paramètre-indicator" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> le paramètre <code>indicator =</code></h3>
<p>Ce paramètre permet de choisir les indicateurs à collecter, ce qui suppose que l’on connaisse leur code. Par exemple, supposons que l’on veuille extraire la population et le PIB pour pouvoir calculer ensuite le PIB par habitant</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="02-API-worldstat.html#cb49-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>))</span>
<span id="cb49-2"><a href="02-API-worldstat.html#cb49-2"></a><span class="kw">dim</span>(df)</span></code></pre></div>
<pre><code>[1] 13237     6</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="02-API-worldstat.html#cb51-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(df,<span class="dv">6</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1960</td>
<td align="right">NA</td>
<td align="right">54211</td>
</tr>
<tr class="even">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1961</td>
<td align="right">NA</td>
<td align="right">55438</td>
</tr>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1962</td>
<td align="right">NA</td>
<td align="right">56225</td>
</tr>
<tr class="even">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1963</td>
<td align="right">NA</td>
<td align="right">56695</td>
</tr>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1964</td>
<td align="right">NA</td>
<td align="right">57032</td>
</tr>
<tr class="even">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">1965</td>
<td align="right">NA</td>
<td align="right">57360</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>commentaire</strong> : Nous obtenons un tableau très grand (&gt; 13000 lignes) qui comporte les valeurs pour toutes les dates disponibles depuis 1960 et pour tous les pays, même si les valeurs sont souvent manquantes.</li>
</ul>
</div>
<div id="le-choix-dune-période-de-temps" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> le choix d’une période de temps</h3>
<div id="les-paramètres-startdate-et-startdate" class="section level4" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> les paramètres <code>startdate =</code> et <code>startdate =</code></h4>
<p>Ces deux paramètres permettent de choisir une plage de temps. On peut par exemple décider de ne collecter que les données relatives aux années 2014, 2015 et 2016</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="02-API-worldstat.html#cb52-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb52-2"><a href="02-API-worldstat.html#cb52-2"></a>                <span class="dt">start_date =</span> <span class="dv">2014</span>,</span>
<span id="cb52-3"><a href="02-API-worldstat.html#cb52-3"></a>                <span class="dt">end_date =</span> <span class="dv">2016</span>)</span>
<span id="cb52-4"><a href="02-API-worldstat.html#cb52-4"></a><span class="kw">dim</span>(df)</span></code></pre></div>
<pre><code>[1] 651   6</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="02-API-worldstat.html#cb54-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(df,<span class="dv">6</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2014</td>
<td align="right">2765363128</td>
<td align="right">103774</td>
</tr>
<tr class="even">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2015</td>
<td align="right">2919553073</td>
<td align="right">104341</td>
</tr>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2016</td>
<td align="right">2965921788</td>
<td align="right">104872</td>
</tr>
<tr class="even">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2014</td>
<td align="right">20484885120</td>
<td align="right">33370794</td>
</tr>
<tr class="odd">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2015</td>
<td align="right">19907111419</td>
<td align="right">34413603</td>
</tr>
<tr class="even">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2016</td>
<td align="right">18017749074</td>
<td align="right">35383128</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>commentaire</strong> : Le tableau ne comporte donc plus que 651 lignes correspondant aux trois dates pour les différents pays du Monde.</li>
</ul>
</div>
<div id="le-paramètre-mrv-most-recent-value" class="section level4" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Le paramètre <code>mrv</code> (most recent value)</h4>
<p>Lorsque l’on souhaite juste obtenir les données les plus récentes, on peut remplacer les paramètres <code>startdate =</code> et <code>startdate =</code> par le paramètre <code>mrv =</code> suivit d’un chiffre indiquant le nombre d’années que l’on souhaite à partir de la date la plus récente. Avec mrv=1 on récupère uniquement la dernière année disponible pour au moins l’une des variables.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="02-API-worldstat.html#cb55-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb55-2"><a href="02-API-worldstat.html#cb55-2"></a>                <span class="dt">mrv =</span> <span class="dv">1</span>)</span>
<span id="cb55-3"><a href="02-API-worldstat.html#cb55-3"></a><span class="kw">dim</span>(df)</span></code></pre></div>
<pre><code>[1] 217   6</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="02-API-worldstat.html#cb57-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(df,<span class="dv">6</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2019</td>
<td align="right">NA</td>
<td align="right">106314</td>
</tr>
<tr class="even">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2019</td>
<td align="right">19291104008</td>
<td align="right">38041754</td>
</tr>
<tr class="odd">
<td align="left">AO</td>
<td align="left">AGO</td>
<td align="left">Angola</td>
<td align="right">2019</td>
<td align="right">88815697793</td>
<td align="right">31825295</td>
</tr>
<tr class="even">
<td align="left">AL</td>
<td align="left">ALB</td>
<td align="left">Albania</td>
<td align="right">2019</td>
<td align="right">15279183290</td>
<td align="right">2854191</td>
</tr>
<tr class="odd">
<td align="left">AD</td>
<td align="left">AND</td>
<td align="left">Andorra</td>
<td align="right">2019</td>
<td align="right">3154057987</td>
<td align="right">77142</td>
</tr>
<tr class="even">
<td align="left">AE</td>
<td align="left">ARE</td>
<td align="left">United Arab Emirates</td>
<td align="right">2019</td>
<td align="right">421142267938</td>
<td align="right">9770529</td>
</tr>
</tbody>
</table>
<p>L’inconvénient de cette méthode est que cela peut aboutir à un grand nombre de valeurs manquantes si l’une des variables recherchée n’a pas été mise à jour. Par exemple, la variable relative au CO2 n’est pas disponible après 2016 et du coup le tableau va mélanger des dates différentes.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="02-API-worldstat.html#cb58-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>,<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span> ),</span>
<span id="cb58-2"><a href="02-API-worldstat.html#cb58-2"></a>                <span class="dt">mrv =</span><span class="dv">1</span>)</span>
<span id="cb58-3"><a href="02-API-worldstat.html#cb58-3"></a><span class="kw">dim</span>(df)</span></code></pre></div>
<pre><code>[1] 434   7</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="02-API-worldstat.html#cb60-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(df,<span class="dv">6</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">EN.ATM.CO2E.KT</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2016</td>
<td align="right">883.747</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">AW</td>
<td align="left">ABW</td>
<td align="left">Aruba</td>
<td align="right">2019</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">106314</td>
</tr>
<tr class="odd">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2016</td>
<td align="right">8672.455</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">AF</td>
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="right">2019</td>
<td align="right">NA</td>
<td align="right">19291104008</td>
<td align="right">38041754</td>
</tr>
<tr class="odd">
<td align="left">AO</td>
<td align="left">AGO</td>
<td align="left">Angola</td>
<td align="right">2016</td>
<td align="right">34693.487</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">AO</td>
<td align="left">AGO</td>
<td align="left">Angola</td>
<td align="right">2019</td>
<td align="right">NA</td>
<td align="right">88815697793</td>
<td align="right">31825295</td>
</tr>
</tbody>
</table>
<p>Il est donc préférable de sélectioner une période plus longue mrv=5 et de faire ensuite soi-même le tri :</p>
</div>
</div>
<div id="le-choix-des-unités-géographiques" class="section level3" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Le choix des unités géographiques</h3>
<p>Le paramètre <code>country =</code> permet de choisir les entités spatiales à collecter, soit sous forme de liste de codes, soit à l’aide de valeurs spéciales. Par défaut; il renvoie la liste de tous les pays, mais on peut se limiter à quelques uns seulement à l’aide de leur nom en anglais (risqué …) ou de leur code ISO3 (plus sûr)</p>
<div id="sélection-de-pays" class="section level4" number="2.4.3.1">
<h4><span class="header-section-number">2.4.3.1</span> sélection de pays</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="02-API-worldstat.html#cb61-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb61-2"><a href="02-API-worldstat.html#cb61-2"></a>                <span class="dt">start_date =</span> <span class="dv">2018</span>,</span>
<span id="cb61-3"><a href="02-API-worldstat.html#cb61-3"></a>                <span class="dt">end_date =</span> <span class="dv">2018</span>,</span>
<span id="cb61-4"><a href="02-API-worldstat.html#cb61-4"></a>                <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;CHN&quot;</span>))</span>
<span id="cb61-5"><a href="02-API-worldstat.html#cb61-5"></a>df<span class="op">$</span>GDP.per.capita &lt;-<span class="st"> </span><span class="kw">round</span>(df<span class="op">$</span>NY.GDP.MKTP.CD <span class="op">/</span><span class="st"> </span>df<span class="op">$</span>SP.POP.TOTL,<span class="dv">0</span>)</span>
<span id="cb61-6"><a href="02-API-worldstat.html#cb61-6"></a><span class="kw">kable</span>(<span class="kw">head</span>(df,<span class="dv">6</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
<th align="right">GDP.per.capita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CN</td>
<td align="left">CHN</td>
<td align="left">China</td>
<td align="right">2018</td>
<td align="right">1.389482e+13</td>
<td align="right">1392730000</td>
<td align="right">9977</td>
</tr>
<tr class="even">
<td align="left">US</td>
<td align="left">USA</td>
<td align="left">United States</td>
<td align="right">2018</td>
<td align="right">2.058016e+13</td>
<td align="right">326687501</td>
<td align="right">62996</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>commentaire</strong> : Il est donc facile de travailler sur un petit nombre de pays que l’on souhaite comparer.</li>
</ul>
</div>
<div id="opérateurs-spéciaux" class="section level4" number="2.4.3.2">
<h4><span class="header-section-number">2.4.3.2</span> Opérateurs spéciaux</h4>
<p>Il existe un certain nombre de paramètres spéciaux que l’on peut utiliser à la place de la liste des pays :</p>
<ul>
<li>“countries_only” (Default)</li>
<li>“regions_only”</li>
<li>“admin_regions_only”</li>
<li>“income_levels_only”</li>
<li>“aggregates_only”</li>
<li>“all”</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="02-API-worldstat.html#cb62-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb62-2"><a href="02-API-worldstat.html#cb62-2"></a>                <span class="dt">start_date =</span> <span class="dv">2018</span>,</span>
<span id="cb62-3"><a href="02-API-worldstat.html#cb62-3"></a>                <span class="dt">end_date =</span> <span class="dv">2018</span>,</span>
<span id="cb62-4"><a href="02-API-worldstat.html#cb62-4"></a>                <span class="dt">country =</span> <span class="st">&quot;regions_only&quot;</span>)</span>
<span id="cb62-5"><a href="02-API-worldstat.html#cb62-5"></a>df<span class="op">$</span>GDP.per.capita &lt;-<span class="st"> </span><span class="kw">round</span>(df<span class="op">$</span>NY.GDP.MKTP.CD <span class="op">/</span><span class="st"> </span>df<span class="op">$</span>SP.POP.TOTL,<span class="dv">0</span>)</span>
<span id="cb62-6"><a href="02-API-worldstat.html#cb62-6"></a><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">iso2c</th>
<th align="left">iso3c</th>
<th align="left">country</th>
<th align="right">date</th>
<th align="right">NY.GDP.MKTP.CD</th>
<th align="right">SP.POP.TOTL</th>
<th align="right">GDP.per.capita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Z4</td>
<td align="left">EAS</td>
<td align="left">East Asia &amp; Pacific</td>
<td align="right">2018</td>
<td align="right">2.635135e+13</td>
<td align="right">2328138066</td>
<td align="right">11319</td>
</tr>
<tr class="even">
<td align="left">Z7</td>
<td align="left">ECS</td>
<td align="left">Europe &amp; Central Asia</td>
<td align="right">2018</td>
<td align="right">2.314567e+13</td>
<td align="right">917922618</td>
<td align="right">25215</td>
</tr>
<tr class="odd">
<td align="left">ZJ</td>
<td align="left">LCN</td>
<td align="left">Latin America &amp; Caribbean</td>
<td align="right">2018</td>
<td align="right">5.823558e+12</td>
<td align="right">640467174</td>
<td align="right">9093</td>
</tr>
<tr class="even">
<td align="left">ZQ</td>
<td align="left">MEA</td>
<td align="left">Middle East &amp; North Africa</td>
<td align="right">2018</td>
<td align="right">3.566141e+12</td>
<td align="right">448912962</td>
<td align="right">7944</td>
</tr>
<tr class="odd">
<td align="left">XU</td>
<td align="left">NAC</td>
<td align="left">North America</td>
<td align="right">2018</td>
<td align="right">2.230365e+13</td>
<td align="right">363809186</td>
<td align="right">61306</td>
</tr>
<tr class="even">
<td align="left">8S</td>
<td align="left">SAS</td>
<td align="left">South Asia</td>
<td align="right">2018</td>
<td align="right">3.445472e+12</td>
<td align="right">1814388744</td>
<td align="right">1899</td>
</tr>
<tr class="odd">
<td align="left">ZG</td>
<td align="left">SSF</td>
<td align="left">Sub-Saharan Africa</td>
<td align="right">2018</td>
<td align="right">1.721156e+12</td>
<td align="right">1078306520</td>
<td align="right">1596</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>commentaire</strong> : Nous avons extrait les données par grandes régions du Monde pour l’année 2016</li>
</ul>
</div>
</div>
<div id="le-format-de-sortie-du-tableau" class="section level3" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Le format de sortie du tableau</h3>
<p>Il existe deux façons d’extraire un tableau comprenant plusieurs variables ou plusieurs dates, selon que l’on veut un tableau large (wide) ou étroit. On peut régler la sortie à l’aide du paramètre <code>return_wide</code> qui est TRUE par défaut mais que l’on peut régler sur FALSE.</p>
<div id="return_wide-false" class="section level4" number="2.4.4.1">
<h4><span class="header-section-number">2.4.4.1</span> <code>return_wide</code> = FALSE</h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="02-API-worldstat.html#cb63-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb63-2"><a href="02-API-worldstat.html#cb63-2"></a>                <span class="dt">return_wide =</span> <span class="ot">TRUE</span>,</span>
<span id="cb63-3"><a href="02-API-worldstat.html#cb63-3"></a>                <span class="dt">start_date =</span> <span class="dv">2016</span>,</span>
<span id="cb63-4"><a href="02-API-worldstat.html#cb63-4"></a>                <span class="dt">end_date =</span> <span class="dv">2018</span>,</span>
<span id="cb63-5"><a href="02-API-worldstat.html#cb63-5"></a>                <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;CHN&quot;</span>))</span>
<span id="cb63-6"><a href="02-API-worldstat.html#cb63-6"></a>df</span></code></pre></div>
<pre><code># A tibble: 6 x 6
  iso2c iso3c country        date NY.GDP.MKTP.CD SP.POP.TOTL
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;
1 CN    CHN   China          2016        1.12e13  1378665000
2 CN    CHN   China          2017        1.23e13  1386395000
3 CN    CHN   China          2018        1.39e13  1392730000
4 US    USA   United States  2016        1.87e13   322941311
5 US    USA   United States  2017        1.95e13   324985539
6 US    USA   United States  2018        2.06e13   326687501</code></pre>
</div>
<div id="return_wide-false-1" class="section level4" number="2.4.4.2">
<h4><span class="header-section-number">2.4.4.2</span> <code>return_wide</code> = FALSE</h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="02-API-worldstat.html#cb65-1"></a>df   &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator  =</span> <span class="kw">c</span>(<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>,<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb65-2"><a href="02-API-worldstat.html#cb65-2"></a>                <span class="dt">return_wide =</span> <span class="ot">FALSE</span>,</span>
<span id="cb65-3"><a href="02-API-worldstat.html#cb65-3"></a>                <span class="dt">start_date =</span> <span class="dv">2016</span>,</span>
<span id="cb65-4"><a href="02-API-worldstat.html#cb65-4"></a>                <span class="dt">end_date =</span> <span class="dv">2018</span>,</span>
<span id="cb65-5"><a href="02-API-worldstat.html#cb65-5"></a>                <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;CHN&quot;</span>))</span>
<span id="cb65-6"><a href="02-API-worldstat.html#cb65-6"></a>df[,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]</span></code></pre></div>
<pre><code># A tibble: 12 x 7
   indicator_id   indicator         iso2c iso3c country        date   value
   &lt;chr&gt;          &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;
 1 NY.GDP.MKTP.CD GDP (current US$) CN    CHN   China          2018 1.39e13
 2 NY.GDP.MKTP.CD GDP (current US$) CN    CHN   China          2017 1.23e13
 3 NY.GDP.MKTP.CD GDP (current US$) CN    CHN   China          2016 1.12e13
 4 NY.GDP.MKTP.CD GDP (current US$) US    USA   United States  2018 2.06e13
 5 NY.GDP.MKTP.CD GDP (current US$) US    USA   United States  2017 1.95e13
 6 NY.GDP.MKTP.CD GDP (current US$) US    USA   United States  2016 1.87e13
 7 SP.POP.TOTL    Population, total CN    CHN   China          2018 1.39e 9
 8 SP.POP.TOTL    Population, total CN    CHN   China          2017 1.39e 9
 9 SP.POP.TOTL    Population, total CN    CHN   China          2016 1.38e 9
10 SP.POP.TOTL    Population, total US    USA   United States  2018 3.27e 8
11 SP.POP.TOTL    Population, total US    USA   United States  2017 3.25e 8
12 SP.POP.TOTL    Population, total US    USA   United States  2016 3.23e 8</code></pre>
</div>
</div>
</div>
<div id="exercices-1" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Exercices</h2>
<div id="exercice-1" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Exercice 1</h3>
<p>Extraire les métadonnées relatives à la variable <em>SP.URB.TOTL</em></p>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="55%" />
<col width="19%" />
<col width="12%" />
<col width="1%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">indicator_id</th>
<th align="left">indicator</th>
<th align="left">unit</th>
<th align="left">indicator_desc</th>
<th align="left">source_org</th>
<th align="left">topics</th>
<th align="right">source_id</th>
<th align="left">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SP.URB.TOTL</td>
<td align="left">Urban population</td>
<td align="left">NA</td>
<td align="left">Urban population refers to people living in urban areas as defined by national statistical offices. It is calculated using World Bank population estimates and urban ratios from the United Nations World Urbanization Prospects. Aggregation of urban and rural population may not add up to total population because of different country coverages.</td>
<td align="left">World Bank staff estimates based on the United Nations Population Division’s World Urbanization Prospects: 2018 Revision.</td>
<td align="left">19 , 16 , Climate Change , Urban Development</td>
<td align="right">2</td>
<td align="left">World Development Indicators</td>
</tr>
</tbody>
</table>
<div class="solution-exo">
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="02-API-worldstat.html#cb67-1"></a>meta&lt;-cat<span class="op">$</span>indicators[cat<span class="op">$</span>indicators<span class="op">$</span>indicator_id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SP.URB.TOTL&quot;</span>),]</span></code></pre></div>
</div>
</div>
<div id="exercice-2" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Exercice 2</h3>
<p>Créer un tableau de la population des pays du monde en 2000, triez le par ordre décroissant et affichez les 10 pays les plus peuplés avec leur nom,leur code et la population en millions</p>
<table>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Pays</th>
<th align="right">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CHN</td>
<td align="left">China</td>
<td align="right">1262.6</td>
</tr>
<tr class="even">
<td align="left">IND</td>
<td align="left">India</td>
<td align="right">1056.6</td>
</tr>
<tr class="odd">
<td align="left">USA</td>
<td align="left">United States</td>
<td align="right">282.2</td>
</tr>
<tr class="even">
<td align="left">IDN</td>
<td align="left">Indonesia</td>
<td align="right">211.5</td>
</tr>
<tr class="odd">
<td align="left">BRA</td>
<td align="left">Brazil</td>
<td align="right">174.8</td>
</tr>
<tr class="even">
<td align="left">RUS</td>
<td align="left">Russian Federation</td>
<td align="right">146.6</td>
</tr>
<tr class="odd">
<td align="left">PAK</td>
<td align="left">Pakistan</td>
<td align="right">142.3</td>
</tr>
<tr class="even">
<td align="left">BGD</td>
<td align="left">Bangladesh</td>
<td align="right">127.7</td>
</tr>
<tr class="odd">
<td align="left">JPN</td>
<td align="left">Japan</td>
<td align="right">126.8</td>
</tr>
<tr class="even">
<td align="left">NGA</td>
<td align="left">Nigeria</td>
<td align="right">122.3</td>
</tr>
</tbody>
</table>
<div class="solution-exo">
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="02-API-worldstat.html#cb68-1"></a><span class="co"># Chargement des données avec l&#39;API</span></span>
<span id="cb68-2"><a href="02-API-worldstat.html#cb68-2"></a>tab &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> <span class="kw">c</span>(<span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb68-3"><a href="02-API-worldstat.html#cb68-3"></a>                  <span class="dt">start_date=</span><span class="dv">2000</span>,</span>
<span id="cb68-4"><a href="02-API-worldstat.html#cb68-4"></a>                  <span class="dt">end_date =</span> <span class="dv">2000</span>)</span>
<span id="cb68-5"><a href="02-API-worldstat.html#cb68-5"></a></span>
<span id="cb68-6"><a href="02-API-worldstat.html#cb68-6"></a><span class="co">### Tri, sélection, transformation  et recodage en R-Base</span></span>
<span id="cb68-7"><a href="02-API-worldstat.html#cb68-7"></a> <span class="co"># tab&lt;-tab[order(tab$SP.POP.TOTL,decreasing = T),]</span></span>
<span id="cb68-8"><a href="02-API-worldstat.html#cb68-8"></a> <span class="co"># tab&lt;-tab[,c(&quot;iso3c&quot;,&quot;country&quot;,&quot;SP.POP.TOTL&quot;)]</span></span>
<span id="cb68-9"><a href="02-API-worldstat.html#cb68-9"></a> <span class="co"># tab$SP.POP.TOTL&lt;-tab$SP.POP.TOTL/1000000</span></span>
<span id="cb68-10"><a href="02-API-worldstat.html#cb68-10"></a> <span class="co"># names(tab)&lt;-c(&quot;Code&quot;, &quot;Nom&quot;, &quot;Population&quot;)</span></span>
<span id="cb68-11"><a href="02-API-worldstat.html#cb68-11"></a></span>
<span id="cb68-12"><a href="02-API-worldstat.html#cb68-12"></a><span class="co">### Tri, sélection, transformationet recodage en dplyr</span></span>
<span id="cb68-13"><a href="02-API-worldstat.html#cb68-13"></a>tab&lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-14"><a href="02-API-worldstat.html#cb68-14"></a><span class="st">          </span><span class="kw">arrange</span>(<span class="kw">desc</span>(SP.POP.TOTL)) <span class="op">%&gt;%</span></span>
<span id="cb68-15"><a href="02-API-worldstat.html#cb68-15"></a><span class="st">          </span><span class="kw">select</span>(iso3c, country, SP.POP.TOTL) <span class="op">%&gt;%</span></span>
<span id="cb68-16"><a href="02-API-worldstat.html#cb68-16"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">SP.POP.TOTL =</span> SP.POP.TOTL<span class="op">/</span><span class="dv">1000000</span>) <span class="op">%&gt;%</span></span>
<span id="cb68-17"><a href="02-API-worldstat.html#cb68-17"></a><span class="st">          </span><span class="kw">rename</span>(<span class="dt">Code=</span>iso3c, <span class="dt">Pays =</span> country, <span class="dt">Population =</span> SP.POP.TOTL)</span>
<span id="cb68-18"><a href="02-API-worldstat.html#cb68-18"></a></span>
<span id="cb68-19"><a href="02-API-worldstat.html#cb68-19"></a><span class="co"># Affichage du résultat</span></span>
<span id="cb68-20"><a href="02-API-worldstat.html#cb68-20"></a><span class="kw">kable</span>(<span class="kw">head</span>(tab,<span class="dv">10</span>), <span class="dt">digits=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="exercice-3" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Exercice 3</h3>
<p>On se propose de comparer l’évolution des émissions de CO2 (EN.ATM.CO2E.KT)de la Chine (CHN), l’Inde (IND), la Russie (RUS) le Japon (JPN) et des Etats-Unis d’Amérique (USA) de 1995 à 2015.</p>
<div id="co2-en-valeur-brute-tonnes" class="section level4" number="2.5.3.1">
<h4><span class="header-section-number">2.5.3.1</span> CO2 en valeur brute (tonnes)</h4>
<p>Réalisez un graphique présentant les valeurs de CO2 en milliers de tonnes avec une échelle logarithmique sur l’axe y pour mieux visualiser les taux de croissance.</p>
<p><img src="Data-Mining-1_files/figure-html/unnamed-chunk-43-1.svg" width="672" /></p>
<div class="solution-exo">
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="02-API-worldstat.html#cb69-1"></a><span class="co"># Chargement des données avec l&#39;API</span></span>
<span id="cb69-2"><a href="02-API-worldstat.html#cb69-2"></a>tab &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> <span class="kw">c</span>(<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>),</span>
<span id="cb69-3"><a href="02-API-worldstat.html#cb69-3"></a>                  <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;CHN&quot;</span>,<span class="st">&quot;IND&quot;</span>,<span class="st">&quot;RUS&quot;</span>,<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;JPN&quot;</span>),</span>
<span id="cb69-4"><a href="02-API-worldstat.html#cb69-4"></a>                  <span class="dt">start_date=</span><span class="dv">1995</span>,</span>
<span id="cb69-5"><a href="02-API-worldstat.html#cb69-5"></a>                  <span class="dt">end_date =</span> <span class="dv">2015</span>)</span>
<span id="cb69-6"><a href="02-API-worldstat.html#cb69-6"></a></span>
<span id="cb69-7"><a href="02-API-worldstat.html#cb69-7"></a>p&lt;-<span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y =</span> EN.ATM.CO2E.KT, <span class="dt">color=</span> country) <span class="op">+</span></span>
<span id="cb69-8"><a href="02-API-worldstat.html#cb69-8"></a><span class="st">                  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb69-9"><a href="02-API-worldstat.html#cb69-9"></a><span class="st">                  </span><span class="kw">scale_y_log10</span>(<span class="st">&quot;en milliers de t&quot;</span>) <span class="op">+</span></span>
<span id="cb69-10"><a href="02-API-worldstat.html#cb69-10"></a><span class="st">                  </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="st">&quot;Principaux pays émetteurs de CO2 (1995-2015)&quot;</span>,</span>
<span id="cb69-11"><a href="02-API-worldstat.html#cb69-11"></a>                          <span class="dt">subtitle =</span> <span class="st">&quot;Source : Banque Mondiale - API wbstat&quot;</span>)</span>
<span id="cb69-12"><a href="02-API-worldstat.html#cb69-12"></a></span>
<span id="cb69-13"><a href="02-API-worldstat.html#cb69-13"></a>p</span></code></pre></div>
</div>
</div>
<div id="co2-en-valeur-relative-tonnes-par-habitant" class="section level4" number="2.5.3.2">
<h4><span class="header-section-number">2.5.3.2</span> CO2 en valeur relative (tonnes par habitant)</h4>
<p>Même exercice mais en téléchargeant aussi la population (SP.POP.TOTL) de façon à calculer la variable CO2.per.capita qui mesure le nombre de tonnes de CO2 par habitant. On utilisera cette fois-ci une échelle arithmétique sur l’axe vertical.</p>
<p><img src="Data-Mining-1_files/figure-html/unnamed-chunk-45-1.svg" width="672" /></p>
<div class="solution-exo">
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="02-API-worldstat.html#cb70-1"></a><span class="co"># Chargement des données avec l&#39;API</span></span>
<span id="cb70-2"><a href="02-API-worldstat.html#cb70-2"></a>tab &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> <span class="kw">c</span>(<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>, <span class="st">&quot;SP.POP.TOTL&quot;</span>),</span>
<span id="cb70-3"><a href="02-API-worldstat.html#cb70-3"></a>                  <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;CHN&quot;</span>,<span class="st">&quot;IND&quot;</span>,<span class="st">&quot;RUS&quot;</span>,<span class="st">&quot;USA&quot;</span>,<span class="st">&quot;JPN&quot;</span>),</span>
<span id="cb70-4"><a href="02-API-worldstat.html#cb70-4"></a>                  <span class="dt">start_date=</span><span class="dv">1995</span>,</span>
<span id="cb70-5"><a href="02-API-worldstat.html#cb70-5"></a>                  <span class="dt">end_date =</span> <span class="dv">2015</span>)</span>
<span id="cb70-6"><a href="02-API-worldstat.html#cb70-6"></a></span>
<span id="cb70-7"><a href="02-API-worldstat.html#cb70-7"></a>tab &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">CO2.per.capita =</span> <span class="dv">1000</span><span class="op">*</span>EN.ATM.CO2E.KT<span class="op">/</span>SP.POP.TOTL)</span>
<span id="cb70-8"><a href="02-API-worldstat.html#cb70-8"></a></span>
<span id="cb70-9"><a href="02-API-worldstat.html#cb70-9"></a><span class="co"># Visualisation avec ggplot2</span></span>
<span id="cb70-10"><a href="02-API-worldstat.html#cb70-10"></a>p&lt;-<span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y =</span> CO2.per.capita, <span class="dt">color=</span> country) <span class="op">+</span></span>
<span id="cb70-11"><a href="02-API-worldstat.html#cb70-11"></a><span class="st">                  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb70-12"><a href="02-API-worldstat.html#cb70-12"></a><span class="st">                  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;en tonnes par habitant&quot;</span>) <span class="op">+</span></span>
<span id="cb70-13"><a href="02-API-worldstat.html#cb70-13"></a><span class="st">                  </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="st">&quot;Principaux pays émetteurs de CO2 (1995-2015)&quot;</span>,</span>
<span id="cb70-14"><a href="02-API-worldstat.html#cb70-14"></a>                          <span class="dt">subtitle =</span> <span class="st">&quot;Source : Banque Mondiale - API wbstat&quot;</span>)</span>
<span id="cb70-15"><a href="02-API-worldstat.html#cb70-15"></a></span>
<span id="cb70-16"><a href="02-API-worldstat.html#cb70-16"></a>p</span></code></pre></div>
</div>
</div>
</div>
<div id="exercice-4" class="section level3" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Exercice 4</h3>
<p>On se propose de comparer les plus grands pays du Monde en combinant deux critères :</p>
<ul>
<li>DEVDUR = Développement durable : mesuré par les quantités de CO2 par habitant</li>
<li>DEVECO = Développement économique : mesurée par le PIB par habitant</li>
</ul>
<div id="analyse-pour-une-année-2010-et-un-seuil-de-population-10-millions" class="section level4" number="2.5.4.1">
<h4><span class="header-section-number">2.5.4.1</span> Analyse pour une année (2010) et un seuil de population (10 millions)</h4>
<p>On construit un programme pour une année précise (2010)et en ne retenant que les pays ayant une population minimale (10 millions d’habitants)</p>
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<pre><code>Warning: Removed 3 rows containing missing values (geom_text).</code></pre>
<p><img src="Data-Mining-1_files/figure-html/unnamed-chunk-47-1.svg" width="672" /></p>
<div class="solution-exo">
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="02-API-worldstat.html#cb73-1"></a><span class="co"># Chargement des données avec l&#39;API</span></span>
<span id="cb73-2"><a href="02-API-worldstat.html#cb73-2"></a>tab &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> <span class="kw">c</span>(<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>, <span class="st">&quot;SP.POP.TOTL&quot;</span>,<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>),</span>
<span id="cb73-3"><a href="02-API-worldstat.html#cb73-3"></a>                  <span class="dt">start_date=</span><span class="dv">2010</span>,</span>
<span id="cb73-4"><a href="02-API-worldstat.html#cb73-4"></a>                  <span class="dt">end_date =</span> <span class="dv">2010</span>)</span>
<span id="cb73-5"><a href="02-API-worldstat.html#cb73-5"></a></span>
<span id="cb73-6"><a href="02-API-worldstat.html#cb73-6"></a>tab &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">DEVDUR =</span> <span class="dv">1000</span><span class="op">*</span>EN.ATM.CO2E.KT<span class="op">/</span>SP.POP.TOTL,</span>
<span id="cb73-7"><a href="02-API-worldstat.html#cb73-7"></a>                      <span class="dt">DEVECO =</span> NY.GDP.MKTP.CD<span class="op">/</span>SP.POP.TOTL,</span>
<span id="cb73-8"><a href="02-API-worldstat.html#cb73-8"></a>                      <span class="dt">POP =</span> SP.POP.TOTL<span class="op">/</span><span class="dv">1000000</span>) <span class="op">%&gt;%</span></span>
<span id="cb73-9"><a href="02-API-worldstat.html#cb73-9"></a><span class="st">                      </span><span class="kw">rename</span>(<span class="dt">Code =</span> iso3c, </span>
<span id="cb73-10"><a href="02-API-worldstat.html#cb73-10"></a>                      <span class="dt">Pays =</span> country) <span class="op">%&gt;%</span></span>
<span id="cb73-11"><a href="02-API-worldstat.html#cb73-11"></a><span class="st">               </span><span class="kw">select</span>(Code,Pays, POP, DEVDUR, DEVECO)<span class="op">%&gt;%</span></span>
<span id="cb73-12"><a href="02-API-worldstat.html#cb73-12"></a><span class="st">               </span><span class="kw">filter</span>(POP <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb73-13"><a href="02-API-worldstat.html#cb73-13"></a>        </span>
<span id="cb73-14"><a href="02-API-worldstat.html#cb73-14"></a></span>
<span id="cb73-15"><a href="02-API-worldstat.html#cb73-15"></a><span class="co"># Visualisation avec ggplot2</span></span>
<span id="cb73-16"><a href="02-API-worldstat.html#cb73-16"></a>p&lt;-<span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>DEVECO, <span class="dt">y =</span> DEVDUR) <span class="op">+</span></span>
<span id="cb73-17"><a href="02-API-worldstat.html#cb73-17"></a><span class="st">                  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>POP),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb73-18"><a href="02-API-worldstat.html#cb73-18"></a><span class="st">                  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>Code), <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">nudge_y=</span><span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb73-19"><a href="02-API-worldstat.html#cb73-19"></a><span class="st">                  </span><span class="kw">scale_x_log10</span>(<span class="st">&quot;PIB par habitant (échelle logarithmique)&quot;</span>) <span class="op">+</span></span>
<span id="cb73-20"><a href="02-API-worldstat.html#cb73-20"></a><span class="st">                  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;CO2 par habitant&quot;</span>) <span class="op">+</span></span>
<span id="cb73-21"><a href="02-API-worldstat.html#cb73-21"></a><span class="st">                  </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="st">&quot;Développement dans le Monde en 2010&quot;</span>,</span>
<span id="cb73-22"><a href="02-API-worldstat.html#cb73-22"></a>                          <span class="dt">subtitle =</span> <span class="st">&quot;Source : Banque Mondiale - API wbstat&quot;</span>)</span>
<span id="cb73-23"><a href="02-API-worldstat.html#cb73-23"></a></span>
<span id="cb73-24"><a href="02-API-worldstat.html#cb73-24"></a>p</span></code></pre></div>
</div>
</div>
<div id="création-dune-fonction-fannée-population" class="section level4" number="2.5.4.2">
<h4><span class="header-section-number">2.5.4.2</span> Création d’une fonction f(année, population)</h4>
<p>On reprend le même programme mais sous forme d’une fonction <code>mongraphique()</code> renvoyant le diagramme en selon le choix de deux paramètres : l’année et le seuil minimal de population. On teste ensuite la fonction pour l’année 1996 et l’année 2016 en prenant un seuil de 50 millions d’habitants.</p>
<p><img src="Data-Mining-1_files/figure-html/unnamed-chunk-49-1.svg" width="672" /></p>
<pre><code>Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<pre><code>Warning: Removed 2 rows containing missing values (geom_text).</code></pre>
<img src="Data-Mining-1_files/figure-html/unnamed-chunk-49-2.svg" width="672" />

<div class="solution-exo">
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="02-API-worldstat.html#cb76-1"></a>mongraphique &lt;-<span class="cf">function</span>(<span class="dt">year =</span> <span class="dv">2010</span>, <span class="dt">minpop =</span> <span class="dv">10</span>)</span>
<span id="cb76-2"><a href="02-API-worldstat.html#cb76-2"></a>{ </span>
<span id="cb76-3"><a href="02-API-worldstat.html#cb76-3"></a></span>
<span id="cb76-4"><a href="02-API-worldstat.html#cb76-4"></a><span class="co"># Chargement des données avec l&#39;API</span></span>
<span id="cb76-5"><a href="02-API-worldstat.html#cb76-5"></a>tab &lt;-<span class="st"> </span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> <span class="kw">c</span>(<span class="st">&quot;EN.ATM.CO2E.KT&quot;</span>, <span class="st">&quot;SP.POP.TOTL&quot;</span>,<span class="st">&quot;NY.GDP.MKTP.CD&quot;</span>),</span>
<span id="cb76-6"><a href="02-API-worldstat.html#cb76-6"></a>                  <span class="dt">start_date=</span>year,</span>
<span id="cb76-7"><a href="02-API-worldstat.html#cb76-7"></a>                  <span class="dt">end_date =</span> year)</span>
<span id="cb76-8"><a href="02-API-worldstat.html#cb76-8"></a></span>
<span id="cb76-9"><a href="02-API-worldstat.html#cb76-9"></a>tab &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">DEVDUR =</span> <span class="dv">1000</span><span class="op">*</span>EN.ATM.CO2E.KT<span class="op">/</span>SP.POP.TOTL,</span>
<span id="cb76-10"><a href="02-API-worldstat.html#cb76-10"></a>                      <span class="dt">DEVECO =</span> NY.GDP.MKTP.CD<span class="op">/</span>SP.POP.TOTL,</span>
<span id="cb76-11"><a href="02-API-worldstat.html#cb76-11"></a>                      <span class="dt">POP =</span> SP.POP.TOTL<span class="op">/</span><span class="dv">1000000</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-12"><a href="02-API-worldstat.html#cb76-12"></a><span class="st">                      </span><span class="kw">rename</span>(<span class="dt">Code =</span> iso3c, </span>
<span id="cb76-13"><a href="02-API-worldstat.html#cb76-13"></a>                      <span class="dt">Pays =</span> country) <span class="op">%&gt;%</span></span>
<span id="cb76-14"><a href="02-API-worldstat.html#cb76-14"></a><span class="st">               </span><span class="kw">select</span>(Code,Pays, POP, DEVDUR, DEVECO)<span class="op">%&gt;%</span></span>
<span id="cb76-15"><a href="02-API-worldstat.html#cb76-15"></a><span class="st">               </span><span class="kw">filter</span>(POP <span class="op">&gt;</span><span class="st"> </span>minpop)</span>
<span id="cb76-16"><a href="02-API-worldstat.html#cb76-16"></a>        </span>
<span id="cb76-17"><a href="02-API-worldstat.html#cb76-17"></a></span>
<span id="cb76-18"><a href="02-API-worldstat.html#cb76-18"></a><span class="co"># Visualisation avec ggplot2</span></span>
<span id="cb76-19"><a href="02-API-worldstat.html#cb76-19"></a>p&lt;-<span class="kw">ggplot</span>(tab) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>DEVECO, <span class="dt">y =</span> DEVDUR) <span class="op">+</span></span>
<span id="cb76-20"><a href="02-API-worldstat.html#cb76-20"></a><span class="st">                  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>POP),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb76-21"><a href="02-API-worldstat.html#cb76-21"></a><span class="st">                  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>Code), <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">nudge_y=</span><span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb76-22"><a href="02-API-worldstat.html#cb76-22"></a><span class="st">                  </span><span class="kw">scale_x_log10</span>(<span class="st">&quot;PIB par habitant (échelle logarithmique)&quot;</span>) <span class="op">+</span></span>
<span id="cb76-23"><a href="02-API-worldstat.html#cb76-23"></a><span class="st">                  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;CO2 par habitant&quot;</span>) <span class="op">+</span></span>
<span id="cb76-24"><a href="02-API-worldstat.html#cb76-24"></a><span class="st">                  </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Développement dans le Monde en &quot;</span>, year),</span>
<span id="cb76-25"><a href="02-API-worldstat.html#cb76-25"></a>                          <span class="dt">subtitle =</span> <span class="st">&quot;Source : Banque Mondiale - API wbstat&quot;</span>)</span>
<span id="cb76-26"><a href="02-API-worldstat.html#cb76-26"></a></span>
<span id="cb76-27"><a href="02-API-worldstat.html#cb76-27"></a>p</span>
<span id="cb76-28"><a href="02-API-worldstat.html#cb76-28"></a>}</span>
<span id="cb76-29"><a href="02-API-worldstat.html#cb76-29"></a></span>
<span id="cb76-30"><a href="02-API-worldstat.html#cb76-30"></a><span class="kw">mongraphique</span>(<span class="dv">1996</span>,<span class="dv">50</span>)</span>
<span id="cb76-31"><a href="02-API-worldstat.html#cb76-31"></a><span class="kw">mongraphique</span>(<span class="dv">2016</span>,<span class="dv">50</span>)</span></code></pre></div>
</div>

</div>
</div>
</div>
</div>
<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="01-API-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="03-API-worldmap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ClaudeGrasland/DataMining1/blob/master/02-API-worldstat.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
